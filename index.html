<!DOCTYPE html>

<head>
    <link rel="shortcut icon" href='images/favicon.png'>
    <title>Run Recap</title>
    <link rel="stylesheet" href="https://myekul.github.io/shared-assets/styles/styles.css">
    <link rel="stylesheet" href="https://myekul.github.io/shared-assets/myekul/myekul.css">
    <link rel="stylesheet" href="https://myekul.github.io/shared-assets/styles/grades.css">
    <link rel="stylesheet" href="https://myekul.github.io/shared-assets/cuphead/cuphead.css">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://apis.google.com/js/api.js"></script>
    <script src="https://www.gstatic.com/charts/loader.js"></script>
    <script src="https://myekul.github.io/shared-assets/utils.js"></script>
    <script src="https://myekul.github.io/shared-assets/cuphead/cuphead.js"></script>
    <script src="https://myekul.github.io/shared-assets/myekul/src.js"></script>
</head>

<body>
    <div id="bodyContent">
        <header>
            <div class='container' style="padding-top:5px">
                <img src="images/favicon.png" style="height:70px">
                <div class="font2" style="font-size:220%">RUN RECAP</div>
            </div>
            <div class='cuphead button'
                style="position:absolute;left:20px;top:13px;font-size:150%;width:50px;height:50px"
                onclick="runRecapDatabase()"><i class="fa fa-cloud"></i>
            </div>
        </header>
        <main>
            <div class="sticky">
                <div id="headerRow" class="container">
                    <div class="font2" style="margin-right:8px">Comm Best</div>
                    <div id='altStratsButton' onclick="altStratIndex=-1;showTab('altStrats')" class="button"
                        style="width:60px;gap:6px;font-size:85%;background-color: limegreen">
                        <i class="fa fa-database"></i>ILs
                    </div>
                    <div id='commBestILsButton' onclick="altStratIndex=-1;showTab('commBestILs')" class="button"
                        style="width:30px;gap:6px;font-size:85%;background-color: limegreen">
                        <i class="fa fa-trophy"></i>
                    </div>
                    <div class="dot"></div>
                    <div id='commBestSplitsButton' onclick="showTab('commBestSplits')" class="button"
                        style="width:80px;gap:6px;font-size:85%;background-color: limegreen">
                        <i class="fa fa-tasks"></i>Splits
                    </div>
                    <div style="width:70px">
                        <div id="boardTitleSrc" class="container">
                            <div class="loader"></div>
                        </div>
                    </div>
                    <div onclick="document.getElementById('runRecap_input').click()" class='button cuphead'
                        style="width:120px;position:absolute;left:15px">
                        <i class="fa fa-folder-open"></i>&nbsp;Open file
                    </div>
                    <input id='input_username' type='text' placeholder='Your SRC username'
                        style='display:none;width:200px;font-size:100%;position:absolute;right:40px;top:4px;'>
                    <div id='username' onclick="showInput('username')" class='container grow'
                        style='display:none;position:absolute;right:40px;color:white;gap:8px'>
                        Your Username...
                        <i class="fa fa-edit" style="font-size:130%"></i>
                    </div>
                </div>
                <div id="progress"></div>
                <div id="tabsDiv"></div>
                <div class='container' style="position:absolute;left:20px;top:55px;align-items: flex-start;">
                    <div id="categoryTabs">
                        <div class="container">
                            <div id='onePointOneButton' onclick="getCommBestILs('1.1+')" class="button onePointOne">
                                1.1+
                            </div>
                        </div>
                        <div class="container">
                            <div id='legacyButton' onclick="getCommBestILs('Legacy')" class="button legacy">Legacy
                            </div>
                        </div>
                        <div class="container">
                            <div id='nmgButton' onclick="getCommBestILs('NMG')" class="button nmg">NMG</div>
                        </div>
                        <div class="container">
                            <div id='dlcButton' onclick="getCommBestILs('DLC')" class="button dlc">DLC</div>
                            <!-- <div class="dlc lobber button" onclick="getCommBestILs('DLC L/S')></div> -->
                            <div id='dlccsButton' class="dlc charge button" onclick="getCommBestILs('DLC C/S')"></div>
                        </div>
                        <div class="container">
                            <div id='dlcbaseButton' onclick="getCommBestILs('DLC+Base')" class="button dlcbase">
                                DLC+Base
                            </div>
                            <!-- <div class="dlcbase lobber button" onclick="getCommBestILs('DLC+Base L/S')"></div> -->
                            <div id='dlcbasecsButton' class="dlcbase charge button"
                                onclick="getCommBestILs('DLC+Base C/S')"></div>
                        </div>
                    </div>
                </div>
                <div id="musicDiv" class='grow' onclick="runRecapMusic()"
                    style="position:absolute;right:20px;top:55px;">
                    <img src="images/gramophone.png" style="height:80px">
                </div>
            </div>
            <div id="pageTitle"></div>
            <div id="boardTitleDiv" class="sticky" style="top:80px;max-width: 50%;margin:0 auto;padding:10px 0">
                <div class="container" style="max-width:50%">
                    <div>
                        <div class="container" style="gap:8px;position:relative">
                            <div id="boardTitle"></div>
                            <div id='commBestSubmit' class="button cuphead"
                                style="display:none;width:120px;gap:8px;position:absolute;left:110%;font-size:90%"
                                onclick="modalSubmitIL()">
                                <i class="fa fa-plus"></i>Submit IL
                            </div>
                        </div>
                    </div>
                    <div id='runRecap_details' class='container'
                        style='display:none;padding-left:25px;margin:0;gap:20px'>
                        <input id='input_runRecap_time' type='text' placeholder='XX:XX'
                            style='display:none;width:65px;font-size:100%'>
                        <div id='runRecap_time' onclick="showInput('runRecap_time')" class='container grow'
                            style='margin:0;gap:8px'></div>
                        <div id='runRecap_player' class='container' style='margin:0;gap:8px'></div>
                        <div id="runRecap_example_div" style="display:none">EXAMPLE</div>
                        <div id="runRecap_theoretical_div" style="display:none">THEORETICAL</div>
                    </div>
                </div>
            </div>
            <div id="runRecap_bar">
                <div class="container" style='padding-bottom:10px'>
                    <div id="runRecap_lss_comparison" class="container" style="margin:0;display:none">
                        <div class='font2' style="padding-right:10px">.lss</div>
                        <select id="dropdown_runRecap_lss_current" class="onePointOne">
                            <option class='lss_yourPB' value="yourPB" selected>Your PB</option>
                            <optgroup label="Theoretical">
                                <option value="yourBest">Best Pace Ever</option>
                                <option value="sob">Sum of Best</option>
                                <option value="theoryRun">Your "Theory Run"</option>
                            </optgroup>
                            <optgroup class="lss_recentRuns" label="Recent Runs"></optgroup>
                        </select>
                        <div>&Delta;</div>
                        <select id="dropdown_runRecap_lss_comparison">
                            <option class="lss_yourPB" value="yourPB">Your PB</option>
                            <option id="lss_prevPB">Previous PB</option>
                            <optgroup label="Theoretical">
                                <option value="yourBest" selected>Best Pace Ever</option>
                                <option value="sob">Sum of Best</option>
                                <option value="theoryRun">Your "Theory Run"</option>
                            </optgroup>
                            <optgroup label="Comm Best Sheet">
                                <option value="wr">World Record</option>
                                <option value="commBest">Comm Best</option>
                                <option value="commSoB">Comm SoB</option>
                            </optgroup>
                            <optgroup class="lss_recentRuns" label="Recent Runs"></optgroup>
                        </select>
                    </div>
                    <div id="runRecap_sav_section" class="container" style="margin:0;display:none">
                        <div id="sav_divider" class="divider"></div>
                        <div class="container grow" style="margin:0;gap:10px;color:gray"
                            onclick="openModal(savComparisonContent(),'SAV COMPARISON')">
                            &Delta;
                            <div id="savComparison">Top 3 Average</div>
                        </div>
                        <!-- <div id='deltaToggle' class="grow" style="font-size:150%;color:gray;margin-left:10px"
                            onclick="deltaType=!deltaType;playSound('move');action()">
                            <i class="fa fa-exchange"></i>
                        </div> -->
                        <img id="runRecap_ghost" style="height:40px;padding-left:20px">
                        <div id="runRecap_numDeaths" style="padding-left:5px"></div>
                    </div>
                </div>
            </div>
            <div id="content"></div>
            <div id="runRecapTab" style="display:none">
                <div class="container">
                    <div>
                        <div id='runRecap_welcome'>
                            <div class="container" style="padding:20px 0">
                                <div class='textBlock'>
                                    Welcome to <span class="myekulColor">Run Recap</span>! This tool allows you
                                    to upload
                                    a <span class="myekulColor">Cuphead .sav</span>
                                    and a <span class="myekulColor">LiveSplit .lss</span> file
                                    to gain valuable insights about your recent run performance.
                                </div>
                            </div>
                        </div>
                        <div class='container'>
                            <div class="rrSec">.sav</div>
                            <div class='textBlock' style="font-size:80%;color:darkgray">
                                You can either upload an existing .sav file from %appdata% to automatically
                                retrieve
                                IL times, or
                                create an empty file and insert IL times manually.
                            </div>
                        </div>
                        <br>
                        <div class='container'>
                            <div class="rrSec">.lss</div>
                            <div class='textBlock' style="font-size:80%;color:darkgray">
                                To ensure file compatibility, please upload a .lss with the standard split
                                configuration, as
                                seen <span class="myekulColor clickable" style="text-decoration: underline;"><a
                                        href="https://docs.google.com/spreadsheets/d/1JgTjjonfC7bh4976NI4pCPeFp8LbA3HMKdvS_47-WtQ"
                                        target="_blank">here</a></span>. Also, please note that comm best
                                comparisons will not work when splitting after scorecard.
                            </div>
                        </div>
                    </div>
                </div>
                <div class="container" style="padding:25px 0;gap:20px">
                    <div style="padding-right:20px">
                        <div class="container">View Example:</div>
                        <div id="runRecap_examples" class="container"></div>
                    </div>
                    <div id="dropbox">
                        <div class="container">
                            <input type='file' id='runRecap_input' onchange="runRecapHandleFile(event)"
                                style='display:none'>
                            <div onclick="document.getElementById('runRecap_input').click()" class='button cuphead'>
                                <i class="fa fa-folder-open"></i>&nbsp;Open file
                            </div>
                            <div onclick="openModal(runRecapInfo(), 'INFO')" class='grow' style="padding-left:5px">
                                <i class="fa fa-info-circle"></i>
                            </div>
                            <div class='divider'></div>
                            <div onclick="processSavFile()" class="button cuphead" style="width:110px">
                                <i class="fa fa-plus"></i>&nbsp;Empty .sav
                            </div>
                        </div>
                    </div>
                </div>
                <div id='runRecapError' class='container' style='display:none'>Error!</div>
            </div>
            <div id="runRecap_content" style="display:none">
                <div class='container' style='padding-top:20px'>
                    <div class="container" style="margin:0">
                        <div class='button cuphead' onclick="showTab('home')"
                            style='width:110px;height:30px;font-size:90%'>
                            <i class="fa fa-reply"></i>&nbsp;Go back
                        </div>
                        <div class='divider'></div>
                        <div class='button cuphead' onclick="runRecapDownload()" style='width:135px'><i
                                class="fa fa-download"></i>&nbsp;Download .sav</div>
                        <div id="completedRun" class="container" style="margin:0">
                            <div class='divider'></div>
                            <div class='button cuphead' onclick="runRecapCopy()" style='width:165px'><i
                                    class="fa fa-clone"></i>&nbsp;Copy to clipboard</div>
                            <div id="runRecap_upload_div" class="container" style="display:none">
                                <div class='divider'></div>
                                <div id='uploadButton' class='button cuphead pulseSize' onclick="runRecapUploadButton()"
                                    style='width:190px;height:30px;font-size:90%'><i
                                        class="fa fa-cloud-upload"></i>&nbsp;Upload to database</div>
                                <div id='uploadCheck' class='container'
                                    style='display:none;width:190px;font-size:200%;margin:0'></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id='runRecap_chart' class='container' style='display:none;width:900px;height:100px'></div>
        </main>
        <footer></footer>
    </div>
</body>

<script src="resources/commBest.js"></script>

<script src="code/variables.js"></script>

<script src="code/runRecap.js"></script>

<script src="code/api/firebase.js" type="module"></script>
<script src="code/api/sheets.js"></script>

<script src="code/tabs/home.js"></script>
<script src="code/tabs/sav.js"></script>
<script src="code/tabs/lss.js"></script>
<script src="code/tabs/sums.js"></script>
<script src="code/tabs/residual.js"></script>
<script src="code/tabs/grid.js"></script>
<script src="code/tabs/ballpit.js"></script>
<script src="code/tabs/commBestILs.js"></script>
<script src="code/tabs/altStrats.js"></script>
<script src="code/tabs/commBestSplits.js"></script>

<script src="code/database.js"></script>
<script src="code/general.js"></script>

<script src="code/main.js"></script>

</html>